<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Obras - Padocard</title>
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div id="app" class="container mt-5">
  <div class="row">
    <div class="col-md-6 offset-md-3">
      <div v-if="obraid !== null" class="alert alert-success" role="alert">
        <strong>Cadastrado com sucesso!</strong> ID: {{ obraid }}
      </div>
      <div class="mb-3">
        <label for="nome" class="form-label">Nome</label>
        <input type="text" class="form-control" v-model="nome" id="nome">
      </div>
      <div class="mb-3">
        <label for="categoria" class="form-label">Categoria</label>
        <select class="form-select" v-model="categoria" id="categoria">
          <option value="" disabled>Selecione a categoria</option>
          <option value="filme">Filme</option>
          <option value="serie">Série</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="creditos" class="form-label">Créditos</label>
        <input type="text" class="form-control" v-model="creditos" id="creditos">
      </div>
      <div class="input-group mb-3">
        <button class="btn btn-primary" @click="enviarRequisicao" :disabled="!camposPreenchidos">Enviar</button>
      </div>
    </div>
  </div>
</div>

<!-- Vue.js -->
<script src="https://cdn.jsdelivr.net/npm/vue@3.2.21/dist/vue.global.prod.js"></script>
<!-- Axios -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
const app = Vue.createApp({
  data() {
    return {
      nome: '',
      categoria: '',
      creditos: '',
      obraid: null
    }
  },
  computed: {
    camposPreenchidos() {
      return this.nome !== '' && this.categoria !== '' && this.creditos !== '';
    }
  },
  methods: {
    async enviarRequisicao() {
      try {
        const response = await axios.post('http://localhost:3000/cadastrar/obra', {
          nome: this.nome,
          categoria: this.categoria,
          imagem: this.creditos
        });
        const data = response.data;
        if (data) {
            this.obraid = data.ID;
          // Limpar campos após a requisição bem-sucedida
          this.nome = '';
          this.categoria = '';
          this.creditos = '';
        }
      } catch (error) {
        console.error('Erro ao enviar requisição:', error);
      }
    }
  }
});

app.mount('#app');
</script>
</body>
</html>
